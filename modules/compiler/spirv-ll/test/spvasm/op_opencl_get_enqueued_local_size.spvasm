; Copyright (C) Codeplay Software Limited. All Rights Reserved.

; RUN: %spirv-ll -a OpenCL -b 64 %spv_file_s | %filecheck %s
                                OpCapability Addresses
                                OpCapability Kernel
                                OpCapability Int64
                           %1 = OpExtInstImport "OpenCL.std"
                                OpMemoryModel Physical64 OpenCL
                                OpEntryPoint Kernel %get_enqueued_local_size_fn "get_enqueued_local_size_fn" %__spirv_BuiltInEnqueuedWorkgroupSize
                                OpDecorate %__spirv_BuiltInEnqueuedWorkgroupSize BuiltIn EnqueuedWorkgroupSize
                      %size_t = OpTypeInt 64 0
                     %size3_t = OpTypeVector %size_t 3
                 %size3_ptr_t = OpTypePointer Input %size3_t
                      %uint_t = OpTypeInt 32 0
                      %void_t = OpTypeVoid
%get_enqueued_local_size_fn_t = OpTypeFunction %void_t

%__spirv_BuiltInEnqueuedWorkgroupSize = OpVariable %size3_ptr_t Input
  %get_enqueued_local_size_fn = OpFunction %void_t None %get_enqueued_local_size_fn_t
                           %2 = OpLabel
                         %res = OpLoad %size3_t %__spirv_BuiltInEnqueuedWorkgroupSize
;CHECK: [[X:%[a-zA-Z0-9]+]] = trunc i64 0 to i32
;CHECK: {{%[a-zA-Z0-9]+}} = call spir_func i64 @_Z23get_enqueued_local_sizej(i32 [[X]])
                           %x = OpCompositeExtract %size_t %res 0
;CHECK: [[Y:%[a-zA-Z0-9]+]] = trunc i64 1 to i32
;CHECK: {{%[a-zA-Z0-9]+}} = call spir_func i64 @_Z23get_enqueued_local_sizej(i32 [[Y]])
                           %y = OpCompositeExtract %size_t %res 1
;CHECK: [[Z:%[a-zA-Z0-9]+]] = trunc i64 2 to i32
;CHECK: {{%[a-zA-Z0-9]+}} = call spir_func i64 @_Z23get_enqueued_local_sizej(i32 [[Z]])
                           %z = OpCompositeExtract %size_t %res 2
                                OpReturn
                                OpFunctionEnd
