// Copyright (C) Codeplay Software Limited
//
// Licensed under the Apache License, Version 2.0 (the "License") with LLVM
// Exceptions; you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     https://github.com/codeplaysoftware/oneapi-construction-kit/blob/main/LICENSE.txt
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
// WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
// License for the specific language governing permissions and limitations
// under the License.
//
// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception

// REQUIRES: images
// RUN: %oclc -execute -enqueue image2CopyInc -arg img,16,repeat(1024,randint(0,254)) -show dst,16,16 -global 16,16,1 -local 16,1,1 %s > %t
// RUN: %filecheck < %t %s

__kernel void image2CopyInc(__read_only image2d_t img, __write_only image2d_t dst) {
	size_t gid0 = get_global_id(0);
	size_t gid1 = get_global_id(1);
	size_t width = (size_t)get_image_width(img);
	size_t height = (size_t)get_image_height(img);

	size_t x = gid0 > width - 1  ? width - 1 : gid0;
	size_t y = gid1 > height - 1 ? height - 1: gid1;
	int2 coord = (int2)(x, y);
	uint4 pxl = read_imageui(img, coord);
	uint4 dstVal = (uint4)(pxl.x + 1, pxl.y + 1, pxl.z + 1, pxl.w + 1);
	write_imageui(dst, coord, dstVal);
}

// CHECK: dst,201,64,182,242,5,104,65,6,133,88,70,144,36,139,134,219,128,107,190,64,62,82,233,43,63,51,183,247,197,21,118,66,199,149,243,112,83,136,66,12,129,178,24,232,8,39,251,159,77,93,123,76,73,236,161,193,183,185,18,125,23,194,109,153,23,70,160,57,58,111,252,54,218,73,214,94,239,220,126,6,93,188,133,108,8,232,29,250,176,125,188,151,135,117,212,222,126,248,227,36,112,88,31,140,194,9,26,150,178,202,217,224,155,244,253,222,165,155,233,120,21,231,211,38,206,171,36,172,213,245,161,91,83,17,72,66,23,19,26,34,161,80,243,249,52,186,173,145,184,54,191,191,229,30,167,7,73,157,94,72,182,222,32,227,152,203,145,253,246,130,203,184,103,30,213,87,208,61,239,117,218,192,95,165,151,216,2,48,76,87,186,254,230,196,33,72,33,227,206,103,135,76,235,208,133,154,213,122,84,152,211,120,68,206,33,94,5,32,42,111,177,22,252,158,95,61,41,10,26,175,243,201,61,93,93,239,255,52,141,178,177,22,92,74,25,241,121,133,39,99,26,43,149,121,166,139,81,238,253,199,58,202,12,99,171,77,82,29,177,85,204,200,2,192,102,108,53,179,198,37,44,191,197,233,143,32,193,80,185,95,2,25,191,154,208,52,213,15,34,95,245,147,151,134,25,71,234,146,27,106,157,19,94,48,130,110,198,4,134,15,13,178,30,17,91,136,51,163,75,135,60,125,149,49,81,184,101,151,148,240,189,62,133,30,54,162,36,31,246,151,248,205,225,24,40,250,33,82,232,122,52,207,134,143,79,95,145,186,167,80,193,233,255,228,199,177,92,167,1,232,143,10,90,137,220,105,244,126,215,5,191,44,66,200,248,104,51,244,213,66,156,66,230,136,125,202,153,224,149,64,20,27,92,103,223,153,189,13,110,109,76,236,101,148,175,171,140,225,119,156,150,205,8,81,170,119,169,141,129,150,250,141,146,231,14,123,218,24,153,202,29,127,6,222,50,129,17,156,129,148,57,119,71,249,236,22,167,224,36,63,117,158,68,55,12,212,224,161,78,160,58,82,24,175,206,8,40,116,206,19,209,62,200,52,6,133,128,3,169,34,65,183,81,143,58,60,227,120,212,130,94,192,98,139,58,61,125,7,31,118,168,164,151,163,58,254,16,2,127,46,52,85,158,51,24,56,176,132,212,136,148,242,62,206,212,89,46,158,160,143,228,248,10,113,214,52,75,109,111,31,222,139,204,129,208,58,124,204,37,67,50,203,102,7,219,166,208,193,198,22,143,240,219,106,148,26,43,203,212,203,199,171,200,69,157,129,252,45,51,72,26,71,224,218,96,107,211,144,38,110,128,113,40,102,244,118,81,119,41,59,214,117,80,215,171,77,246,243,246,238,2,75,185,3,236,157,127,217,109,193,185,206,123,209,76,26,61,194,240,209,29,225,147,132,199,246,81,212,210,231,194,129,114,96,247,252,188,153,94,169,178,118,20,204,82,110,173,23,209,128,42,169,51,33,206,14,219,11,102,211,212,117,219,195,156,186,92,203,62,80,207,159,239,26,17,126,192,70,18,223,40,83,43,179,72,95,187,43,160,114,8,18,170,4,219,236,251,5,41,191,18,230,234,13,188,15,20,212,238,6,13,82,200,102,225,34,108,64,150,25,112,199,5,251,87,64,165,159,19,99,238,146,213,94,65,127,224,254,131,202,22,88,247,148,243,162,25,222,156,167,145,32,222,169,228,152,240,176,225,135,68,50,18,95,50,170,173,78,136,34,116,99,170,236,62,29,28,225,29,219,36,10,124,188,12,105,47,234,224,169,23,23,184,175,194,70,101,72,126,200,80,143,24,230,162,52,182,219,229,119,132,134,151,222,115,248,87,26,115,4,239,27,58,84,247,237,176,220,214,16,157,82,219,108,92,21,120,23,156,120,240,216,23,237,116,27,33,219,76,158,92,132,210,108,255,239,171,9,75,50,196,175,218,23,129,87,98,48,41,30,160,190,104,143,92,219,32,50,238,120,188,99,53,59,118,101,172,173,102,116,73,37,74,230,140,59,208,232,33,154,62,223,87,134,56,78,82,170,160,98,46,172,94,219,243,169,191,86,8,55,174,67,41,52,136,215,7,147,89,125,246,205,250,229,34,141,2,85,156,172,22,148,151,237,182,166,101,234,229,48,82,74,117,86,139,22,156,13,175,145,69,210,89,197,91,17,244,210,1,141,42,171,30,247,252,236,183,137,227,168,205,186,170,198,124,67,205,31,190,130,114,111,174,15
